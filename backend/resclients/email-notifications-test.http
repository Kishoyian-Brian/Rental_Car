### Email Notifications Test for Reviews and Bookings

# Variables
@baseUrl = http://localhost:3000
@authToken = {{login.response.body.data.access_token}}

### Login to get token
# @name login
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "customer@example.com",
  "password": "password123"
}

### Test 1: Create a Review (will trigger emails to Admin & Agent)
POST {{baseUrl}}/reviews
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
  "carId": "car-id-here",
  "rating": 5,
  "comment": "Excellent car! Very clean and well-maintained. Great experience overall."
}

### Test 2: Create a Booking (will trigger emails to Customer, Admin & Agent)
POST {{baseUrl}}/bookings
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
  "carId": "car-id-here",
  "startDate": "2024-01-15T10:00:00Z",
  "endDate": "2024-01-17T18:00:00Z"
}

### Test 3: Confirm a Booking (Admin/Agent only)
PATCH {{baseUrl}}/bookings/booking-id-here/confirm
Authorization: Bearer {{authToken}}

### Test 4: Cancel a Booking
PATCH {{baseUrl}}/bookings/booking-id-here/cancel
Authorization: Bearer {{authToken}}

### Test 5: Complete a Booking (Admin/Agent only)
PATCH {{baseUrl}}/bookings/booking-id-here/complete
Authorization: Bearer {{authToken}}

### Expected Email Flow:

# 1. Review Creation:
#    - Admin receives: "New Review Posted - [Car Make] [Car Model]"
#    - Agent receives: "New Review Posted - [Car Make] [Car Model]"
#    - Email includes: rating, comment, customer name, car details

# 2. Booking Creation:
#    - Customer receives: "Booking Confirmation - [Car Make] [Car Model]"
#    - Admin receives: "New Booking - [Car Make] [Car Model]"
#    - Agent receives: "New Booking - [Car Make] [Car Model]"
#    - Email includes: booking details, dates, price, status

# 3. Booking Status Changes:
#    - Cancellation: Customer + Admin/Agent get cancellation emails
#    - Completion: Customer + Admin/Agent get completion emails

# Note: Make sure SMTP settings are configured in .env:
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=your-email@gmail.com
# SMTP_PASS=your-app-password
# SMTP_FROM=your-email@gmail.com
# FRONTEND_URL=http://localhost:4200 